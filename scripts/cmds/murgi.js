const delay = (ms) => new Promise(res => setTimeout(res, ms));

// active loop storage
const activeMurgi = new Map();

module.exports = {
  config: {
    name: "murgi",
    version: "1.1.0",
    role: 2,
    author: "Acs kabir",
    description: "Loop bad word messages until stopped",
    category: "fun",
    usages: "@mention | reply | off",
    cooldowns: 5,
  },

  onStart: async function({ message, event, args }) {

    // OFF command
    if (args[0] && args[0].toLowerCase() === "off") {
      if (activeMurgi.has(event.threadID)) {
        activeMurgi.set(event.threadID, false);
        return message.reply("ЁЯЫС Murgi mode stopped.");
      } else {
        return message.reply("тЪая╕П Murgi mode is not running.");
      }
    }

    let targetID, name;

    // тЬЕ FIXED MENTION GLITCH (mention + reply)
    if (event.mentions && Object.keys(event.mentions).length > 0) {
      targetID = Object.keys(event.mentions)[0];
      name = event.mentions[targetID];
    } 
    else if (event.messageReply) {
      targetID = event.messageReply.senderID;
      name = event.messageReply.senderName || "User";
    } 
    else {
      return message.reply("Please @mention or reply to a target first!");
    }

    const arraytag = [{ id: targetID, tag: name }];

    const messages = [
      "ржЦрж╛*ржиржХрж┐рж░ ржкрзЛрж▓рж╛ рж░рзЗржбрж┐ рждрзЛ ржЪрзБ*ржжрж╛ ржЦрж╛ржУрзЯрж╛рж░ ржЬржирзНржп ЁЯШИ ",
      "ржПржЦржи рждрзЛрж░ ржорж╛рж░ ржжрзБржз ржжрж░рзЗ ржШрзБржорж╛ржорзБ рж╕ржХрж╛рж▓рзЗ рждрзЛрж░ ржмрж╛ржкрж░рзЗ ржкрзБржХржЯрж┐ ржорж╛рж░рждрзЗ ржЬрж╛ржорзБ ржЧрзБржб ржирж╛ржЗржЯ ржЫрзЛржЯ ЁЯШЪ",
      "рж╢рзБржи ржЦрж╛ржиржХрж┐рж░ ржкрзЛрж▓рж╛ ржЗржбрзЗржЯ ржХрж░рждрзЗ ржХрж░рждрзЗ ржоржЗрж░рж╛ ржпрж╛ ржкрзЛрж╕рзНржЯ ржХржЗрж░рж╛ ржлрзЗржорж╛рж╕ ржХрж░ ржЖржорж╛рж░рзЗ, ЁЯЩД",
      "ржЧрж╛рж▓рж╛ржЧрж╛рж▓рж┐ ржХрж░рждрзЗ ржХрж░рждрзЗ рждрзЛрж░ ржмрзБрж░рж┐ ржорж╛рж░рзЗ рж╕рж╕рзНрждрж╛ ржмрж╛ржирж┐рзЯрзЗ ржлрзЗрж▓ржЫрж╕",
      "ржПржЗ ржЗрж╣рзБржжрж┐рж░ ржкрзБржд ржПрж╕ржм ржЫрж╛рзЬрж╛ ржЦрж╛ржиржХрж┐рж░ ржкрзЛрж▓рж╛ ржХрж┐ ржкрж╛рж░ржЫ",
      "тФАтФАтФАтФАтФАржХрж╛ржирж╛ рждрзЛрж░ ржорж╛рж░ ржХрж╛рж▓рж╛ ржкрзБрж╢рж┐рж░ ржпрзЗ ржЧржирзНржз рждрзБржЗ ржПржЯрж╛ ржжрж┐рзЯрзЗ ржХрж┐ржнрж╛ржмрзЗ ржмрзЗрж░ рж╣ржЗрж▓рж┐ рж╢рж╛рж▓рж╛ ржЖржмрж╛рж░ ржбрзБржХрзЗ ржпрж╛ ЁЯдг",
      "тФАтФАтФАтФАтФАрждрзЛрж░ ржЖржмрзНржмрзБрж░ ржПрж░ ржирж╛ржо ржирж┐рзЯрзЗ ржЖрж░ ржХрждрзЛ ржЪрж▓ржмрж┐ ржЧрж░рж┐ржмрзЗрж░ ржмрж╛ржЪрзНржЪрж╛ЁЯдг",
      "тФАтФАтФАтФАтФАржлржХрж┐ржирзНржирж┐рж░ ржкрзЛрж▓рж╛ ржЯрж┐ржирзЗрж░ ржШрж░рзЗрж░ ржорзБржЪрж┐ЁЯдг",
      "тФАтФАтФАтФАтФАрждрзЛрж░ ржорж╛рж░ ржорждрзЛ ржмрзЗрзЬрж┐ ржЖржорж╛рж░ ржзржирзЗрж░ ржЧрзЛрзЬрж╛рж░ ржмрж╛рж▓ ржХрж╛ржЯрждрзЗ рж░рж╛ржЦрж┐ ржЬрж╛ржирзБ ржмрзЗржЧржо ржПрж░ ржП ржпрзЛржЧрзНржпрждрж╛ ржУ ржирж╛ржЗЁЯдг",
      "рждрж░ ржорж╛рж░рзЗ рззрзи ржорж╛рж╕ ржЪрзБржжрзЗ ржЧрзЗрж▓рзЗржУ ржУрж░ ржнрзЛржжрж╛рж░ ржХрж┐ржЫрзБ рж╣ржмрзЗ ржирж╛ ржХрж╛рж░ржи ржорж╛ржЧрж┐ рждрзЛ ржнрзЛржжрж╛ рж▓рзЛрж╣рж╛ ржмрж╛ржирж╛ржпрж╝ ржжрж┐ржЫрзЗ ЁЯШ╣ЁЯТеЁЯж╢",
      "тФАтФАтФАтФАрждрзЛрж░ ржорж╛рж░рзЗ ржЪрзБржЗржжрж╛ ржЬрзАржмржирзЗрж░ рж╕ржмржЪрж╛ржЗрждрзЗ ржмржбрж╝ ржнрзБрж▓ ржХрж░ржЫрж┐рж▓рж╛ржо ржЖрж░ ржПржЗ ржнрзБрж▓рзЗрж░ рж╕рж╛ржерзЗ ржПржЦржи ржкрзЗрждрзЗ рж╣ржЪрзНржЫрзЗред рждрзЛрж░ ржоржд ржирж╛рж╕рзНрждрж┐ржХ ржЬржирзНржо рж╣ржЗржпрж╝рж╛ред ЁЯЩВЁЯШЭ",
      "я╕Пя╕Пя╕Пя╕Пя╕ПтОптОпржЦрж╛ржиржХрж┐рж░ ржкрзЛрж▓рж╛ рж╕рж┐ржи ржирж╛ ржжрж┐рж▓рзЗ рждрзЛрж░ ржорж╛рж░ ржмрзЛржжрж╛ ржХрж╛ржоржбрж╝рж╛ржпрж╝рж╛ ржЦрзЗржпрж╝рзЗ ржлрзЗрж▓ржмрзЛред ЁЯШВЁЯШж",
      "тАФтЩбрж╢рзЗрж╖ ржирж┐рж╢рзНржмрж╛рж╕ ржкрж░рзНржпржирзНржд ржЖржкржирж╛рж░ ржорж╛ржХрзЗ ржЪрзБржжрждрзЗ  ржЪрж╛ржЗ ржХрж┐ ржмрж▓рзЗржи ржЖржкржирж┐-!! >тЩбЁЯй╖ЁЯЩВЁЯл╢",
      "ржиржбрж┐рж░ ржкрзБржд рж╕ржорзЯ ржерж╛ржХрждрзЗ ржнрж╛рж▓рзЛ рж╣рзЛ ржЦрж╛ржиржХрж┐рж░ ржкрзЛрж▓рж╛ ржлрзЗрж░рж╛ржЙржирзЗрж░ ржмрж╛ржЪрзНржЪрж╛ ржЧрж╛рж▓рж╛ржЧрж╛рж▓рж┐ ржХрж░рж╛ рж╕ржнрж╛ржм рж╣рзЯрзЗ ржЧрзЗржЫрзЗ ржЪрзБржЗржжрзНржжрж╛ ржХрж┐ржирзНрждрзБ ржорж╛ржЗрж░рж╛ рж▓рж╛ржорзБ",
      " рждрзЛрж░ ржорж╛рж░рзЗ ржирж┐рзЯрзЗ ржХрж╛рж▓ржХрзЛ ржкрзЛрж╕рзНржЯ ржжрж┐ржорзБЁЯдб",
      " ржиржбрж┐рж░ ржкрзБржд рж╕ржорзЯ ржерж╛ржХрждрзЗ ржнрж╛рж▓рзЛ рж╣рзЛ ржЦрж╛ржиржХрж┐рж░ ржкрзЛрж▓рж╛ ржлрзЗрж░рж╛ржЙржирзЗрж░ ржмрж╛ржЪрзНржЪрж╛ ржЧрж╛рж▓рж╛ржЧрж╛рж▓рж┐ ржХрж░рж╛ рж╕ржнрж╛ржм рж╣рзЯрзЗ ржЧрзЗржЫрзЗ ржЪрзБржЗржжрзНржжрж╛ ржХрж┐ржирзНрждрзБ ржорж╛ржЗрж░рж╛ рж▓рж╛ржорзБ",
      " рждрзЛрж░ рж▓рзЗржВржЯрж╛ ржорж╛рзЯрж░рзЗ ржмрж┐рж▓рж╛ржЗрзЯрзЗрж░ ржзрзЛ*ржи ржжрж┐рзЯрзЗ ржЪрзБржжрж┐ ЁЯдгЁЯдгЁЯШВ",
      " тФАтФАтФАтФАрждрзЛрж░ ржорж╛рж░рзЗ ржЪрзБржЗржжрж╛ ржЬрзАржмржирзЗрж░ рж╕ржмржЪрж╛ржЗрждрзЗ ржмржбрж╝ ржнрзБрж▓ ржХрж░ржЫрж┐рж▓рж╛ржо ржЖрж░ ржПржЗ ржнрзБрж▓рзЗрж░ рж╕рж╛ржерзЗ ржПржЦржи ржкрзЗрждрзЗ рж╣ржЪрзНржЫрзЗред рждрзЛрж░ ржоржд ржирж╛рж╕рзНрждрж┐ржХ ржЬржирзНржо рж╣ржЗржпрж╝рж╛ред ЁЯЩВЁЯШЭ",
      "тЬз╦ЦтФА рждрзЛрж░ ржорж╛рж░рзЗ ржЪрзБржжрж┐, ржмрж░ржл рж╢рзАрждрж▓ ржжрзЗрж╢рзЗ ржирж┐рзЯрзЗ, ржорж╛ржЧрж┐рж░ ржкрзБржд ЁЯе╡ЁЯШ╣ЁЯШ╣ ",
      " рждрж░ ржорж╛рж░рзЗ ржЬржиржЧржгрзЗрж░ ржоржзрзНржпрзЗ ржлрж╛рж▓рж╛ржЗржпрж╝рж╛ ржЪрзЛржжржмрзЛ ЁЯШ╣ЁЯСЛ",
      " ______ ржорж╛ржЧрж┐ ржкрж╛ржбрж╝рж╛рж░ ржЫрж┐ржБржбрж╝рж╛ ржХржирзНржбржо ржжрж┐ржпрж╝рзЗ рждрзЛрж░ ржмрзЛржирж░рзЗ ржЪрзЛржжрж┐!-)ЁЯдгЁЯдг",
      " рждрзЛрж░ ржорж╛рж░рзЗ ржкрж╛ржХрж┐рж╕рзНрждрж╛ржирзЗрж░ рж╕рж╛ржмрзЗржХ ржкрзНрж░рзЗрж╕рж┐ржбрзЗржирзНржЯ ржЯрзНрж░рж╛ржорзНржк ржкрзНрж░рж╢рж╛рж╕ржи рж╕рзЗржЬрзЗ ржЪрзБржжрж┐",
      "рж╢рзАрждрзЗрж░ ржХржорзНржкрж▓рзЗрж░ рждрзЛрж▓рзЗ ржлрж╛рж▓рж╛ржЗржпрж╝рж╛ рждрзЛрж░ ржорж╛ржпрж╝рж░рзЗ ржз!рж░рзНрж╖ржг ржХрж░ржмрзЛ ржЙржЬрж╛ржирзА ржорж╛!ржЧрзАрж░ ржкрзЛрж▓рж╛",
      " рждрзЛрж░ ржорж╛ржпрж╝рж░рзЗ ржЙржбрж╝ржирзНржд тЬИя╕Пржмрж┐ржорж╛ржирзЗ ЁЯТдржШрзБржоржирзНржд ржЕржмрж╕рзНржерж╛ржпрж╝ рж▓рзЗржВржЯрж╛ ржХрж░рзЗ рж╕рзБржжрзА",
      " тФАтФАтФА ржПржЗ ржХрж╛ржЗрж▓рзНрж▓рж╛ ржлрж╛ржбрж╛ ржЦрж╛ржоржХрж┐рж░ ржЫрзЗрж▓рзЗ ржЖржорж╛рж░ рззрзи ржЗржЮрзНржЪрж┐ ржзржи ржжрж┐рзЯрж╛ ржПржоржи ржмрж╛рзЬрж┐ ржжрж┐ржорзБ рждрж░ ржмрж╛ржмрж╛рж░ ржирж╛ржо ржнрзБрж▓рзЗ ржпрж╛ржмрж┐ ржЦржирж┐ржХрзЗрж░ ржкрзЛрж▓рж╛",
      " ржирж╛рж╕рзНрждрж┐ржХредЁЯж╢ЁЯШ╣ _____ рждрзЛрж░ ржмрзЛржирзЗрж░ ржнрзЛржжрж╛ржпрж╝ ржУржпрж╝рж╛ржХ ржерзБ ржиржбрж┐рж░ ржмрж╛ржЪрзНржЪрж╛",
      " тОптОптОп ржП ржирж╛рж╕рзНрждрж┐ржХ ржорж╛ржЧрж┐рж░ ржкрзЛрж▓рж╛ рждрзЛрж░ ржорж╛рж░рзЗ рж╣рж┐ржирзНржжрзБ ржмрзМржжрзНржз ржЦрзНрж░рж┐рж╕рзНржЯрж╛ржи ржжрж┐рзЯрзЗ ржЪрзБржжрж╛ржмрзЛЁЯШ╣тЬЛ",
      " рждрж░ ржорж╛рж░рзЗ ржЧрзБрж▓рж┐рж╕рзНрждрж╛ржирзЗрж░ ржЕрж▓рж┐рждрзЗ ржЧрж▓рж┐рждрзЗ ржЪрж┐ржкрж╛ржпрж╝ ржЪрж╛ржкрж╛ржпрж╝ рж▓рзЗржВржЯрж╛ ржХрж░рзЗ ржЪрзБржжрж┐ ЁЯШ╣",
      " тФАтФАтФАтФАрждрзЛрж░ ржорж╛рж░ ржХржкрж╛рж▓рзЗ ржЬрзБрждрж╛ ржжрж┐ржпрж╝рж╛ ржкрж┐ржЯрж╛ржЗрждрзЗ рж╣ржЗржмрзЛ ржУржЗ ржЦрж╛ржиржХрж┐ржорж╛ржЧрзА ржХрзЗржи рждрзЛрж░рзЗ ржЬржирзНржо ржжрж┐рж▓рзЛредЁЯЩВЁЯШКЁЯОА",
      " тОптОптОп ржП ржорж╛ржЧрзАрж░ржкрзБржд рждрзЛрж░ ржорж╛рж░рзЗ ржарж╛ржХрзБрж░ржЧрж╛ржБржУ ржирж┐рзЯрзЗ ржарж╛ржХрзБрж░ ржжрж┐рзЯрзЗ ржЪрзБржжржмрзЛ!ЁЯШ╣тЬЛ",
      " ржХрж╛рж▓рж╛ ржлрж╛ржбрж╛ ржорж╛ржЧрж┐рж░ ржкрзЛрж▓рж╛",
      " рждрж░ ржорж╛рж░рзЗ ржЪрзБржжрж┐ ржорж╛ржЧрж┐рж░ ржкрзЛрж▓рж╛ рзйред ржлрзБржЯ ЁЯШ╣ЁЯСЛ",
      "___ржмрзИрж╢рж╛ржЦрзА ржЭрж░рзЗрж░ ржоржзрзНржпрзЗ рждрзЛрж░ ржорж╛ржХрзЗ ржорж╛ржарзЗ ржлрзЗрж▓рзЗ ржЪрзБржжрж┐рж╣рж╣рж╣ ржмрж╛ржирзНржзрж┐рж░ ржкрзБрж▓рж╛-//ЁЯМ╜ЁЯР╣ЁЯН╛ЁЯзЬтАНтЩАя╕П ",
      " рждрж░ ржорж╛рж░рзЗ ржХрзБржХрзБрж░ ржжрж┐ржпрж╝рзЗ ржЪрзБржжрж╛ржмрзЛ ржорж╛ржЧрж┐рж░ ржкрзЛрж▓рж╛",
      " я╕Пя╕Пя╕Пя╕Пя╕ПтОптОп  рждрзЛрж░ ржорж╛рж░ ржмрзЛржжрж╛рж░ ржорж╛ржВрж╕ ржХрж╛ржЗржЯрзНржЯрж╛ ржХрзБрждрзНрждрж╛рж░рзЗ ржЦрж╛ржиржХрж┐рж░ ржкрзЛрж▓рж╛",
      " я╕Пя╕Пя╕Пя╕Пя╕ПтОптОп ржХрж┐рж░рзЗ ржмрж╛ржирзНржжрж┐рж░ ржкрзЛрж▓рж╛ рждрзБржЗ ржирж╛ржХрж┐ рж╣рзНржпрж╛ржХрж╛рж░",
      " я╕Пя╕Пя╕Пя╕Пя╕ПтОптОп   ржХрж┐рж░рзЗ ржкрж╛ ржЪрж╛ржЯрж╛ ржХрзБрждрзНрждрж╛ ржорж╛ржЧрж┐рж░ ржкрзБржд ?",
      " ___рждрж░ ржорж╛рж░ ржнрзБржжрж╛рзЯ ржбрж┐ржЬрзЗрж▓ ржбрзЗрж▓рзЗ ржЖржЧрзБрзБржи рж▓рж╛ржЧрж┐рзЯрж╛  ржжрзВрж░ ржжрж┐ржорзЛ ржорж╛ржЧрж┐рж░ ржкрзЛрж▓рж╛",
      "ЁЯШ╣_____ рждрзЛрж░ ржХржЪрж┐ ржмрзЛржиржХрзЗ ржмрж┐ржпрж╝рзЗ ржжрж┐ржмрж┐ рж░рзЗржирзНржбрж┐ ржорж╛ржЧрж┐рж░ ржмрж╛ржЪрзНржЪрж╛!ЁЯСЕ ",
    ];

    activeMurgi.set(event.threadID, true);
    message.reply("ЁЯФе Murgi mode started.");

    try {
      while (activeMurgi.get(event.threadID)) {
        for (const msg of messages) {
          if (!activeMurgi.get(event.threadID)) break;

          await delay(2500);
          message.reply({
            body: `${name}\n${msg}`,
            mentions: arraytag
          });
        }
      }
    } catch (err) {
      console.error(err);
      activeMurgi.delete(event.threadID);
      message.reply("Something went wrong!");
    }
  }
};
